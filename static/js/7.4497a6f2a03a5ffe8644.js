webpackJsonp([7],{YxtC:function(t,e){},gdx1:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Xgv0"),a=n("zH3I"),r=n.n(a),s=n("//Fk"),o=n.n(s),c=n("d7EF"),l=n.n(c),u=n("Gu7T"),h=n.n(u),v=n("Xxa5"),d=n.n(v),p=n("exGp"),f=n.n(p),m=n("Zrlr"),_=n.n(m),b=n("wxAW"),k=n.n(b),g=n("5IcD"),w=n.n(g),x=n("zf2T");function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 0==e?Object(x.a)(t):e>0?Object(x.a)(t).times(Object(x.a)("1"+"0".repeat(e))):Object(x.a)(t).div(Object(x.a)("1"+"0".repeat(-e)))}function T(t){return y(t,-18)}x.a.config({DECIMAL_PLACES:18,ROUNDING_MODE:x.a.ROUND_DOWN,EXPONENTIAL_AT:256});var C=function(){function t(){_()(this,t),this.web3=null,this.addresses=null,this.abifiles=null,this.methods=null,this.providerUrl=null,this.pool=null,this.bToken=null,this.symbol=null,this.bSymbol=null,this.multiplier=null,this.feeRatio=null,this.minInitialMarginRatio=null,this.balance={},this.position={volume:y(0),cost:y(0),lastCumuFundingRate:y(0),margin:y(0),lastUpdateTimestamp:y(0)}}return k()(t,[{key:"initialize",value:function(){var t=f()(d.a.mark(function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._initializeContracts(e);case 2:return t.next=4,this._initializeParameters();case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"tradeEvent",value:function(){var t=f()(d.a.mark(function t(){var e,n,i,a,r,s,o,c,l,u,h,v=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0x4C059dD7b01AAECDaA3d2cAf4478f17b9c690080";return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={owner:v},t.next=3,this._getPastEvents(this.pool,"Trade",e);case 3:n=t.sent,i=[],a=0;case 6:if(!(a<n.length)){t.next=20;break}return r=n[a],s=r.returnValues,t.next=11,this._getTimeStamp(r.blockNumber);case 11:o=t.sent,c=T(y(s.tradeVolume)),l=T(y(s.price)),u=c.abs().times(l).times(this.multiplier).times(this.minInitialMarginRatio),h=c.gt(0)?"LONG":"SHORT",i.push({direction:h,baseToken:this.bSymbol,price:T(s.price).toString(),volume:T(s.tradeVolume).toString(),notional:u.toString(),transactionFee:this._calculateFee(c,l),time:+o.timestamp+"000"});case 17:a++,t.next=6;break;case 20:return t.abrupt("return",i);case 21:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"_calculateFee",value:function(t,e){return y(t).abs().times(e).times(this.multiplier).times(this.feeRatio).toString()}},{key:"_getPastEvents",value:function(){var t=f()(d.a.mark(function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getPastEvents(n,{filter:i,fromBlock:0,toBlock:"latest"},function(t,e){return e});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"_getTimeStamp",value:function(){var t=f()(d.a.mark(function t(e){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.web3.eth.getBlock(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_call",value:function(){var t=f()(d.a.mark(function t(e,n){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(i=e.methods)[this.methods[n]].apply(i,h()(a)).call();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"_readjson",value:function(){var t=f()(d.a.mark(function t(e){var n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("static/config/"+e);case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"_initializeContracts",value:function(){var t=f()(d.a.mark(function t(e){var n,i,a,r,s,c,u;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._readjson("config.json");case 3:return n=t.sent,this.providerUrl=n.kovanProviderUrl,this.addresses=n.addresses[e],this.abifiles=n.abifiles,this.methods=n.methods,t.next=10,o.a.all([this._readjson(this.abifiles.pool),this._readjson(this.abifiles.bToken),this._readjson(this.abifiles.pToken),this._readjson(this.abifiles.lToken)]);case 10:i=t.sent,a=l()(i,4),r=a[0],s=a[1],c=a[2],u=a[3],this.web3=new w.a(new w.a.providers.HttpProvider(this.providerUrl)),this.pool=new this.web3.eth.Contract(r,this.addresses.pool),this.bToken=new this.web3.eth.Contract(s,this.addresses.bToken),this.pToken=new this.web3.eth.Contract(c,this.addresses.pToken),this.lToken=new this.web3.eth.Contract(u,this.addresses.lToken),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(0),console.log("Chain: _initializeContracts() error: "+t.t0);case 26:case"end":return t.stop()}},t,this,[[0,23]])}));return function(e){return t.apply(this,arguments)}}()},{key:"_initializeParameters",value:function(){var t=f()(d.a.mark(function t(){var e;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._call(this.pool,"getParameters");case 3:return e=t.sent,t.next=6,this._call(this.bToken,"symbol");case 6:this.bSymbol=t.sent,this.multiplier=T(e.multiplier),this.feeRatio=T(e.feeRatio),this.minInitialMarginRatio=T(e.minInitialMarginRatio),this.minMaintenanceMarginRatio=T(e.minMaintenanceMarginRatio),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log("Chain: _initializeParameters() error: "+t.t0);case 16:case"end":return t.stop()}},t,this,[[0,13]])}));return function(){return t.apply(this,arguments)}}()}]),t}(),S=new i.a,R=new C,j={name:"pools",data:function(){return{data:[],account:"",id:0}},methods:{connectwallet:function(){var t=this;S.connectWallet().then(function(e){console.log(e),e.success&&(t.account=e.account,R.initialize(t.id).then(function(e){R.tradeEvent(t.account).then(function(e){console.log(e),t.data=e.reverse(),t.data.map(function(t){t.volume=Math.abs(t.volume),t.time=r()(+t.time).format("YYYY-MM-DD HH:mm:ss")}),console.log(t.data)})}))})}},mounted:function(){this.id=this.$route.params.id,this.connectwallet()}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{color:"#fff"},attrs:{id:"history"}},[n("div",{staticClass:"container-fluid ml-0"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-lg-12 ml-0 mt-5",staticStyle:{"overflow-y":"hidden"}},[n("div",{staticClass:"banner"},[n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row mt-2"},[n("table",{staticClass:"table table-hover table-dark table-border sidebar-bg"},[t._m(0),t._v(" "),n("tbody",t._l(t.data,function(e){return n("tr",{key:e.index,staticStyle:{height:"4.4rem"}},[n("td",{},[t._v(t._s(e.time))]),t._v(" "),n("td",{},[t._v(t._s(e.direction))]),t._v(" "),n("td",{},[t._v(t._s(e.baseToken))]),t._v(" "),n("td",{},[t._v(t._s(e.price))]),t._v(" "),n("td",{},[t._v(t._s(e.volume))]),t._v(" "),n("td",{},[t._v(t._s(e.notional))]),t._v(" "),n("td",{},[t._v(t._s(e.transactionFee))])])}),0)])])])])])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",{staticStyle:{"background-color":"#141924"}},[n("tr",{staticStyle:{height:"3.8rem","background-color":"#141924"}},[n("th",{staticClass:"text-left",attrs:{scope:"col"}},[t._v("Time")]),t._v(" "),n("th",{attrs:{scope:"col"}},[t._v("Direction")]),t._v(" "),n("th",{attrs:{scope:"col"}},[t._v("Base Token")]),t._v(" "),n("th",{attrs:{scope:"col"}},[t._v("Price")]),t._v(" "),n("th",{attrs:{scope:"col"}},[t._v("Volume")]),t._v(" "),n("th",{attrs:{scope:"col"}},[t._v("Notional")]),t._v(" "),n("th",{attrs:{scope:"col"}},[t._v("Transaction Fee")])])])}]};var M=n("VU/8")(j,E,!1,function(t){n("YxtC")},"data-v-12966e96",null);e.default=M.exports}});